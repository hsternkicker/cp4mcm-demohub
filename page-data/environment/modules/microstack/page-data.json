{"componentChunkName":"component---src-pages-environment-modules-microstack-mdx","path":"/environment/modules/microstack/","result":{"pageContext":{"frontmatter":{"title":"Installing Openstack instance as managed environment for CloudForms","description":"IBM Cloud Pak for MCM additional modules - Openstack as the managed VM platform"},"relativePagePath":"/environment/modules/microstack.mdx","titleType":"page","MdxNode":{"id":"ce2505b7-c0de-5f77-9ec2-4de49f98b1c7","children":[],"parent":"4b111367-694b-5788-973d-efd1ef401a54","internal":{"content":"---\ntitle: Installing Openstack instance as managed environment for CloudForms\ndescription: IBM Cloud Pak for MCM additional modules - Openstack as the managed VM platform\n---\n\n## Preparing the Virtual Server Instance\n\n1. In order to create an Openstack instance in IBM Cloud following this procedure you need to setup a VPC and create a Gen2 virtual server instance (VSI) with Ubuntu 18.04. For the testing purpose I have used `bx2-8x32` profile. Instance needs to be assigned with the floating IP to provide connectivity to the Internet.\n\n2. Connect to the VSI. Update the Ubuntu\n\n   ```bash\n   apt-get update\n   apt-get upgarde -y\n   ```\n\n   In case of warning over the `sshd_config` file you can either keep the local version or use the maintainer package.\n\n## Installing the Openstack\n\n3. Install the Microstack\n\n   ```bash\n   snap install microstack --classic --beta\n   ```\n\n   The installation should take less then 5 minutes (depends on the network speed) and if all works as expected will finish with the following message:\n\n   ```bash\n   2020-06-03T08:03:07Z INFO Waiting for restart...\n   microstack (beta) stein from Canonical✓ installed\n   ```\n\n4. Initialize the Microstack\n   MicroStack needs to be initialised, so that networks and databases get configured. To do this, run:\n\n   ```bash\n   microstack.init --auto\n   ```\n\n   Initialization process may take 10-15 minutes.\n\n5. Create alias for Openstack CLI\n\n   ```bash\n   alias os=\"microstack.openstack\"\n   ```\n\n## Exposing the Openstack endpoints on the external IP\n\nBy default Microstack creates intenal network 10.20.20.1/24 and this network is used for exposing API endpoints. You need to expose public endpoints in VSI external IP, so the CloudForms can connect to the Openstack services.\n\n6. Edit the default security group in your VPC, adding incoming rule for port 5000\n7. Change the default admin password. (Default is `keystone`).\n\n\n\nopenstack endpoint create --region microstack volumev2 public http://10.20.20.1:8776/v2/%\\(project_id\\)s\nopenstack endpoint create --region microstack volumev2 internal http://10.20.20.1:8776/v2/%\\(project_id\\)s\nopenstack endpoint create --region microstack volumev2 admin http://10.20.20.1:8776/v2/%\\(project_id\\)s\nopenstack endpoint create --region microstack volumev3 public http://10.20.20.1:8776/v3/%\\(project_id\\)s\nopenstack endpoint create --region microstack volumev3 internal http://10.20.20.1:8776/v3/%\\(project_id\\)s\nopenstack endpoint create --region microstack volumev3 admin http://10.20.20.1:8776/v3/%\\(project_id\\)s","type":"Mdx","contentDigest":"5b5f807715f1312c3178bb0c042845af","counter":758,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"Installing Openstack instance as managed environment for CloudForms","description":"IBM Cloud Pak for MCM additional modules - Openstack as the managed VM platform"},"exports":{},"rawBody":"---\ntitle: Installing Openstack instance as managed environment for CloudForms\ndescription: IBM Cloud Pak for MCM additional modules - Openstack as the managed VM platform\n---\n\n## Preparing the Virtual Server Instance\n\n1. In order to create an Openstack instance in IBM Cloud following this procedure you need to setup a VPC and create a Gen2 virtual server instance (VSI) with Ubuntu 18.04. For the testing purpose I have used `bx2-8x32` profile. Instance needs to be assigned with the floating IP to provide connectivity to the Internet.\n\n2. Connect to the VSI. Update the Ubuntu\n\n   ```bash\n   apt-get update\n   apt-get upgarde -y\n   ```\n\n   In case of warning over the `sshd_config` file you can either keep the local version or use the maintainer package.\n\n## Installing the Openstack\n\n3. Install the Microstack\n\n   ```bash\n   snap install microstack --classic --beta\n   ```\n\n   The installation should take less then 5 minutes (depends on the network speed) and if all works as expected will finish with the following message:\n\n   ```bash\n   2020-06-03T08:03:07Z INFO Waiting for restart...\n   microstack (beta) stein from Canonical✓ installed\n   ```\n\n4. Initialize the Microstack\n   MicroStack needs to be initialised, so that networks and databases get configured. To do this, run:\n\n   ```bash\n   microstack.init --auto\n   ```\n\n   Initialization process may take 10-15 minutes.\n\n5. Create alias for Openstack CLI\n\n   ```bash\n   alias os=\"microstack.openstack\"\n   ```\n\n## Exposing the Openstack endpoints on the external IP\n\nBy default Microstack creates intenal network 10.20.20.1/24 and this network is used for exposing API endpoints. You need to expose public endpoints in VSI external IP, so the CloudForms can connect to the Openstack services.\n\n6. Edit the default security group in your VPC, adding incoming rule for port 5000\n7. Change the default admin password. (Default is `keystone`).\n\n\n\nopenstack endpoint create --region microstack volumev2 public http://10.20.20.1:8776/v2/%\\(project_id\\)s\nopenstack endpoint create --region microstack volumev2 internal http://10.20.20.1:8776/v2/%\\(project_id\\)s\nopenstack endpoint create --region microstack volumev2 admin http://10.20.20.1:8776/v2/%\\(project_id\\)s\nopenstack endpoint create --region microstack volumev3 public http://10.20.20.1:8776/v3/%\\(project_id\\)s\nopenstack endpoint create --region microstack volumev3 internal http://10.20.20.1:8776/v3/%\\(project_id\\)s\nopenstack endpoint create --region microstack volumev3 admin http://10.20.20.1:8776/v3/%\\(project_id\\)s","fileAbsolutePath":"/Users/dymaczew/Documents/_code/mcm/cp4mcm-demohub/src/pages/environment/modules/microstack.mdx"}}},"staticQueryHashes":["1364590287","2102389209","2102389209","227138135","227138135","2456312558","2746626797","2746626797","3018647132","3018647132","3906363820","3906363820","768070550"]}